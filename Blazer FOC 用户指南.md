# Blazer FOC 用户指南

## 前言

​		无刷电机广泛应用于机器人领域，相比直流有刷电机，具有转矩大，响应快，精度高等优点。要实现优异的运动控制效果，不仅需要电机本身的特性足够良好，更取决于驱动器的性能。传统的方波电调操作简单，兼容大部分电机，但难以做到细腻的控制效果，很多情况下无法满足机器人的需求，使用了**FOC**（**field-oriented control**）的驱动，能够对电机进行力矩、速度和位置的三环控制，响应速度和控制精度都是传统电调无法比拟的。

​		Blazer FOC始于2023年，由西安交通大学<u>机器人俱乐部</u>（**Robocon**）提供研发支持，WJY完成初代版本的软硬件实现。研制该驱动的目的在于对现有的成品驱动实现自主化替代，降低使用门槛，并节省费用开销。目前已实现的大功率叠层版本（60A），针对适配的电机，可以完成有感的电流环、速度环和位置环。

## 一、硬件

### 1.元件选型

MCU : **STM32F405RGT6**

栅极驱动 : **FD6288Q**

MOSFET : **HYG006N04LS1TA** 40V 600A 或 **HYG011N04LS1TA** 40V 320A

采样电阻 : **1mΩ** **3920**

电流感应放大器 : **INA240A1PWR**

磁编码器 : **TLE5012BE1000** 或 **MT6816-STD**

屏幕 :  **0.78寸OLED SH1107**

### 2.整体布局

![Controller Top](C:\Robocon\图片\Controller Top.png)

![Controller Bottom](C:\Robocon\图片\Controller Bottom.png)



## 二、软件

### 1.参数定义



### 2.CAN协议

Blazer FOC使用标准帧进行CAN通信，帧ID由节点ID和参数ID组成，格式为

​                                                         **ID段：节点ID<<8 | 参数ID  数据段：32位float**



### 3.UART协议

UART协议采用ASCII通信，格式为

​                            **读写段+参数段+数据段+结束符**

读写段包含  **r_**    (read) 或  **w_**   (write)两种命令

参数段为对应想要读写的某项参数，如**spd**   (speed)   **pos**   (position) 等

数据段为对应读写参数的值，前加  **=** ，读指令无数据段

结束符为 **\r\n**

例如写速度期望值为60，则发送

​                            **w_spd=3.14\r\n**

读当前母线电压，则发送

​                            **r_vbs\r\n**





